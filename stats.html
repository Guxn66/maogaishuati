<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ä¹ ç»Ÿè®¡ - æ¯›æ¦‚åˆ·é¢˜</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-card: #252542;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b8;
            --accent: #6366f1;
            --success: #10b981;
            --danger: #ef4444;
            --radius: 16px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .header {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            background: var(--bg-secondary);
            gap: 16px;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
        }

        .header h1 { font-size: 20px; }

        .container {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        /* æ€»è§ˆå¡ç‰‡ */
        .overview {
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 20px;
        }

        .overview h2 {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 16px;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.8;
            margin-top: 4px;
        }

        /* åŒºå— */
        .section {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 16px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* é”™é¢˜åˆ—è¡¨ */
        .wrong-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .wrong-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wrong-item:hover {
            background: rgba(99, 102, 241, 0.2);
        }

        .wrong-rank {
            width: 28px;
            height: 28px;
            background: var(--danger);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 600;
            margin-right: 12px;
        }

        .wrong-info {
            flex: 1;
        }

        .wrong-title {
            font-size: 14px;
            margin-bottom: 4px;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .wrong-stats {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .wrong-count {
            color: var(--danger);
            font-weight: 600;
        }

        /* æ— æ•°æ® */
        .empty {
            text-align: center;
            padding: 32px;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        /* æ“ä½œæŒ‰é’® */
        .actions {
            margin-top: 24px;
        }

        .btn-clear {
            width: 100%;
            padding: 14px;
            background: var(--bg-card);
            border: 1px solid var(--danger);
            border-radius: 12px;
            color: var(--danger);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-clear:hover {
            background: var(--danger);
            color: white;
        }
    </style>
</head>
<body>
    <header class="header">
        <button class="back-btn" onclick="goBack()">â†</button>
        <h1>ğŸ“Š å­¦ä¹ ç»Ÿè®¡</h1>
    </header>

    <div class="container">
        <!-- æ€»è§ˆ -->
        <div class="overview">
            <h2>ç­”é¢˜æ€»è§ˆ</h2>
            <div class="stats-row">
                <div class="stat-item">
                    <div class="stat-value" id="total-attempts">0</div>
                    <div class="stat-label">ç­”é¢˜æ¬¡æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">æ­£ç¡®ç‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="wrong-count">0</div>
                    <div class="stat-label">é”™é¢˜æ•°</div>
                </div>
            </div>
        </div>

        <!-- è–„å¼±é¢˜ç›® -->
        <div class="section">
            <h3 class="section-title">ğŸ”¥ è–„å¼±é¢˜ç›®ï¼ˆé”™è¯¯æ¬¡æ•°æœ€å¤šï¼‰</h3>
            <div class="wrong-list" id="wrong-list">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- æ“ä½œ -->
        <div class="actions">
            <button class="btn-clear" onclick="clearStats()">ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰ç»Ÿè®¡æ•°æ®</button>
        </div>

        <!-- ç‰ˆæœ¬å· -->
        <div style="text-align:center;padding:20px;color:#666;font-size:12px;">
            v1.0.0
        </div>
    </div>

    <script src="js/storage.js"></script>
    <script src="js/questions.js"></script>
    <script>
        function init() {
            const globalStats = Storage.getGlobalStats();
            const accuracy = Storage.getAccuracyRate();
            const wrongQuestions = Storage.getWeakQuestions(10);

            document.getElementById('total-attempts').textContent = globalStats.totalAttempts;
            document.getElementById('accuracy').textContent = accuracy + '%';
            document.getElementById('wrong-count').textContent = wrongQuestions.length;

            renderWrongList(wrongQuestions);
        }

        function renderWrongList(wrongQuestions) {
            const container = document.getElementById('wrong-list');

            if (wrongQuestions.length === 0) {
                container.innerHTML = `
                    <div class="empty">
                        <div class="empty-icon">ğŸ‰</div>
                        <p>æš‚æ— é”™é¢˜ï¼Œç»§ç»­ä¿æŒï¼</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = wrongQuestions.map((item, index) => {
                const question = maogaiQuestions.find(q => q.id === item.id);
                const questionText = question ? question.question : `é¢˜ç›® ${item.id}`;
                const shortText = questionText.length > 30 ? questionText.slice(0, 30) + '...' : questionText;

                return `
                    <div class="wrong-item" onclick="goToPractice(${item.id})">
                        <div class="wrong-rank">${index + 1}</div>
                        <div class="wrong-info">
                            <div class="wrong-title">ç¬¬${item.id}é¢˜ï¼š${shortText}</div>
                            <div class="wrong-stats">
                                é”™è¯¯ <span class="wrong-count">${item.wrong}æ¬¡</span> Â· 
                                æ­£ç¡® ${item.correct}æ¬¡
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function goToPractice(questionId) {
            // æ‰¾åˆ°é¢˜ç›®ç´¢å¼•
            const index = maogaiQuestions.findIndex(q => q.id === questionId);
            if (index >= 0) {
                window.location.href = `practice.html?mode=sequential&start=${index}`;
            }
        }

        function clearStats() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰ç»Ÿè®¡æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                Storage.clearAllStats();
                alert('å·²æ¸…é™¤æ‰€æœ‰æ•°æ®');
                init();
            }
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
